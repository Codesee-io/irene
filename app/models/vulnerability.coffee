`import DS from 'ember-data'`
`import ENUMS from 'irene/enums'`
`import { translationMacro as t } from 'ember-i18n'`

Vulnerability = DS.Model.extend
  i18n: Ember.inject.service()
  name: DS.attr 'string'
  uuid: DS.attr 'string'
  description: DS.attr 'string'
  question: DS.attr 'string'
  successMessage: DS.attr 'string'
  moreInfo: DS.attr 'string'
  heading: DS.attr 'string'
  intro: DS.attr 'string'
  complaint: DS.attr 'string'
  platform: DS.attr 'number'
  nonComplaint: DS.attr 'string'
  relatedTo: DS.attr 'string'
  businessImplication: DS.attr 'string'
  types: DS.attr()
  statics: t("statics")
  dynamic: t("dynamic")
  manual: t("manual")

  tags: (->
    types = @get "types"
    statics = @get "statics"
    dynamic = @get "dynamic"
    manual = @get "manual"
    return [] if types is undefined
    tags = []
    for type in types
      if type is ENUMS.VULNERABILITY_TYPE.STATIC
        tags.push statics
      if type is ENUMS.VULNERABILITY_TYPE.DYNAMIC
        tags.push dynamic
      if type is ENUMS.VULNERABILITY_TYPE.MANUAL
        tags.push manual
    tags
  ).property "types"

`export default Vulnerability`
