!function(t,e,n){"use strict";var i={init:function(){this.environment(),this.error(),this.xhr()},environment:function(){for(var t,n=e.getElementsByTagName("script"),i=0,r=n.length;r>i;i++)if(n[i].src.indexOf("sherlog")>-1){t=n[i].getAttribute("data-environment");break}this.environment=t||""},error:function(){var e=this;t.onerror=function(t,n,i,r,o){var s=o?o.stack:null;e.format([t,n,i,r,s],0),e.inject()}},event:function(t){this.format(t,1),this.inject()},xhr:function(){var t,e,i,r=this,o=n.prototype.open,s=n.prototype.send;n.prototype.open=function(n,r){i=new Date,t=n,e=r,o.apply(this,arguments)},n.prototype.send=function(){var n=this,o=function(o){if(4==n.readyState)try{var s,a=o.target.status.toString(),c=new Date-i,h=/^[45]/.test(a.slice(0,-2));if(!h)return;try{s=JSON.parse(o.target.response)}catch(p){s=o.target.response.substring(0,100)}r.format([t,a,s,e,c],2),r.inject()}catch(p){}};this.addEventListener("readystatechange",o,!1),s.apply(this,arguments)}},format:function(t,e){switch(this.type=e,this.type){case 0:this.data={message:t[0],source:t[1],line:t[2],column:t[3],stack:t[4]};break;case 1:this.data="object"!=typeof t?{_event:t}:t;break;case 2:this.data={method:t[0],status:t[1],response:t[2],url:t[3],response_time:t[4]}}},url:function(){var e="&t="+this.type+"&d="+encodeURIComponent(JSON.stringify(this.data))+"&cw="+screen.width+"&ch="+screen.height+"&e="+encodeURIComponent(this.environment);return t.location.protocol+"//sherlog.appknox.com/t.gif?ts="+(new Date).getTime()+e},inject:function(){var t=document.createElement("img");t.style.visibility="hidden",t.src=this.url(),e.getElementsByTagName("body")[0].appendChild(t),t.parentNode.removeChild(t)}},r={push:function(t,e){if("undefined"!=typeof t)try{i.event(t),e.call(null)}catch(n){}}};i.init(),t.Sherlog=t.Sherlog||r}(window,document,XMLHttpRequest);
